# 日記アプリ仕様書

## 1. 概要・デザイン
- **構成**: HTML, CSS, JavaScript (Vanilla JS) で構成（ビルド不要）
- **デザイン**: `nikki2.html` を完全再現する
  - ベースカラー: パステルオレンジ (`#FF9F68`)、薄いベージュ背景 (`#FFFCF7`)
  - アクセント: パステルグリーン (`#D9F4D3`)
  - フォント: ヒラギノ角ゴ, Noto Sans JP
  - 形状: 角丸（border-radius 20px）、カード型レイアウト
- **レスポンシブ**: スマホとパソコン両方で崩れずに表示

## 2. データ構造・制約
- **1日1記事制限**: 同じ日付に複数の記事は作成できない
- **保存先**: Firebase (Firestore / Storage)
- **認証**: Firebase Authentication (Email/Password) ※新規登録機能なし、既存アカウントでログイン

## 3. 画面遷移・初期動作
1. **アプリ起動時**
   - ブラウザのローカルストレージを確認
   - **Firebase設定/ログイン情報がない場合**: 「設定・ログイン画面」を表示
   - **設定済みの場合**: 「今日の日記入力（編集）画面」を表示

## 4. 機能要件

### A. 設定・ログイン画面
- 初回または設定未完了時に表示
- **入力項目**:
  - Firebase Config情報（API Key, Project ID等）
  - ログイン用メールアドレス
  - ログイン用パスワード
- **動作**:
  - 「保存してログイン」ボタンで認証を行う
  - 成功したらローカルストレージに保存し、メイン画面へ移動

### B. 日記入力・編集画面（メイン画面）
`nikki2.html` のUIを使用。新規作成と既存記事の編集を兼ねる。

- **ヘッダー**:
  - **メニューボタン** (左上): クリックでメニュー展開（後述）
  - **日付表示**: 選択中の日付を表示（例：2025/11/21）
- **テキスト欄**:
  - 複数行入力可能
- **写真機能**:
  - カメラアイコンボタン（SVG）
  - 複数枚アップロード可能（最大5枚）
  - **処理**: クライアント側で横幅1024pxにリサイズ・圧縮してからアップロード
  - プレビュー表示（サムネイル）
- **気分スタンプ**:
  - 5種類の固定アイコン（SVG使用）から1つ選択
  - 選択したアイコンは色が濃くなる等のアクティブ表示
- **カレンダーハイライト色**:
  - 5色のパステルカラー（赤、紫、青、緑、黄）から選択
  - **デフォルト**: 赤 (`bg-red`)
  - ここで選んだ色が、カレンダー画面でのその日の背景色になる
- **操作ボタン**:
  - **OKボタン**: 保存処理を実行
  - **削除ボタン**: 編集モード（既存記事がある場合）のみ表示
- **保存動作**:
  - Firestoreにテキスト、気分、色情報を保存
  - Storageに画像を保存
  - 保存完了後、「カレンダー画面」へ遷移

### C. カレンダー画面
- **表示**:
  - 月ごとのカレンダー表示
  - **ナビゲーション**: 前の月/次の月、前の年/次の年、今月に戻る
- **日付セルの状態**:
  - **今日**: 枠線や太字などで強調
  - **記事あり**: 記事作成時に選んだ「ハイライト色」が背景色になる
  - **記事なし**: デフォルトの背景色
- **アクション**:
  - **記事がある日をクリック**: その日の「編集画面」へ遷移
  - **記事がない日をクリック**: その日の「新規入力画面」へ遷移

### D. メニュー（ハンバーガーボタン押下時）
- **今日ボタン**: 今日の日付の入力画面へ移動
- **今まで（カレンダー）ボタン**: カレンダー画面へ移動
- **設定ボタン**: Firebase設定・再ログイン画面へ移動（必要に応じて）

## 5. 技術詳細
- **ライブラリ**: Firebase SDK (v9 modular) をCDNから読み込む
- **画像圧縮**: Canvas API等を使用してブラウザ上でリサイズ処理を行う
- **状態管理**: 選択中の日付、Firebaseインスタンス等を管理